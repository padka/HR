# Environment configuration
# Valid values: development, staging, production
# IMPORTANT: In production, Redis is REQUIRED (InMemory broker is prohibited)
ENVIRONMENT=development

# Bot integration configuration
# Toggle the integration entirely (set to "false" to disable Test 2 automation)
BOT_ENABLED=true

# Currently only the Telegram provider is supported
BOT_PROVIDER=telegram

# Telegram bot token (required when BOT_ENABLED=true)
BOT_TOKEN=
# HMAC secret for bot callback data (32+ chars, must differ from SESSION_SECRET)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
BOT_CALLBACK_SECRET=

# Optional overrides for custom Telegram API endpoints
BOT_API_BASE=
BOT_USE_WEBHOOK=false
BOT_WEBHOOK_URL=
BOT_AUTOSTART=true
BOT_INTEGRATION_ENABLED=true

# Logging
LOG_LEVEL=INFO
LOG_JSON=false
LOG_FILE=

# Redis configuration
# REQUIRED in production for notification broker and distributed workers
# Optional in development (will use in-memory fallback if not provided)
#
# For local development with docker-compose:
#   Notifications: REDIS_URL=redis://localhost:6379/0
#   Cache:         REDIS_URL=redis://localhost:6380/0
#
# Example production with separate instances:
#   REDIS_URL=redis://localhost:6379/0         (notifications)
#   CACHE_REDIS_URL=redis://localhost:6380/0   (cache, optional)
REDIS_URL=
# TTL for candidate state in seconds (default: 7 days)
STATE_TTL_SECONDS=604800
# Notification broker backend: "memory" (default, dev only) or "redis"
NOTIFICATION_BROKER=memory

# Rate limiting configuration
# Enable/disable rate limiting (recommended: true for production, false for dev)
RATE_LIMIT_ENABLED=false
# Redis URL for rate limiting (defaults to REDIS_URL with database /1)
# Example: RATE_LIMIT_REDIS_URL=redis://localhost:6379/1
RATE_LIMIT_REDIS_URL=
# Trust X-Forwarded-For headers (only enable when behind reverse proxy)
# Set to true if using nginx, Cloudflare, AWS ALB, etc.
TRUST_PROXY_HEADERS=false

# Notification worker configuration
# Interval (seconds) between poll cycles when the scheduler triggers the worker.
NOTIFICATION_POLL_INTERVAL=3.0
# Max number of outbox items claimed per poll.
NOTIFICATION_BATCH_SIZE=100
# Average Telegram send rate (messages per second); set to 0 to disable throttling.
NOTIFICATION_RATE_LIMIT_PER_SEC=10.0
NOTIFICATION_WORKER_CONCURRENCY=1
# Base/maximum backoff in seconds for retry strategy.
NOTIFICATION_RETRY_BASE_SECONDS=30
NOTIFICATION_RETRY_MAX_SECONDS=3600
# Maximum delivery attempts before the message is marked as failed definitively.
NOTIFICATION_MAX_ATTEMPTS=8

# Control Test 2 dispatch requirements
TEST2_REQUIRED=false
BOT_FAILFAST=false

# Optional admin chat id
ADMIN_CHAT_ID=7588303412

# Admin UI authentication
# IMPORTANT: Use a strong password (16+ characters, mixed case, numbers, symbols)
ADMIN_USER=admin
ADMIN_PASSWORD=

# Documentation exposure (set to "true" to enable /docs and /openapi.json)
ADMIN_DOCS_ENABLED=false

# Session and cookie settings
# IMPORTANT: Generate a strong secret (minimum 32 characters) using:
#   python -c "import secrets; print(secrets.token_hex(32))"
# Example: SESSION_SECRET=a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2
SESSION_SECRET=
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_SAMESITE=strict

# Database configuration
# Development fallback (no DATABASE_URL) â†’ sqlite+aiosqlite:///./data/bot.db
# Other environments fallback to ~/.recruitsmart_admin/data/bot.db
#DATABASE_URL=sqlite+aiosqlite:///./data/bot.db
#DATABASE_URL=postgresql+asyncpg://recruitsmart:recruitsmart@localhost:5432/recruitsmart

# Database connection pool settings (PostgreSQL/MySQL only, ignored for SQLite)
# Recommended for production to prevent "pool exhausted" errors
# Pool size: number of connections to maintain in the pool
DB_POOL_SIZE=20
# Max overflow: additional connections allowed beyond pool_size
DB_MAX_OVERFLOW=10
# Pool timeout: seconds to wait for a connection before raising error
DB_POOL_TIMEOUT=30
# Pool recycle: recycle connections after this many seconds (prevents stale connections)
DB_POOL_RECYCLE=3600

# Default timezone for bot fallback
TZ=Europe/Moscow
