{% extends "base.html" %}
{% block title %}Редактирование рекрутёра{% endblock %}
{% block content %}
<style>
  .form-card { padding:24px; border-radius:20px; backdrop-filter:blur(30px); border:1px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.04); max-width:720px; }
  .form-card__header { display:flex; justify-content:space-between; align-items:flex-start; gap:16px; margin-bottom:24px; }
  .form-card__header h1 { margin:0; font-size:24px; font-weight:600; }
  .form-grid { display:grid; gap:16px; }
  .field { display:flex; flex-direction:column; gap:6px; }
  .field input, .field select { padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.25); color:inherit; }
  .field--inline { flex-direction:row; align-items:center; gap:10px; }
  .city-grid { display:grid; gap:10px; grid-template-columns:repeat(auto-fit, minmax(160px, 1fr)); }
  .city-tile { position:relative; display:flex; flex-direction:column; gap:4px; padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.22); cursor:pointer; transition:background .2s, border-color .2s; }
  .city-tile input { position:absolute; inset:0; opacity:0; cursor:pointer; }
  .city-tile__title { font-weight:600; }
  .city-tile__meta { font-size:12px; color:var(--muted,rgba(255,255,255,0.55)); }
  .city-tile:has(input:checked) { border-color:rgba(79,141,253,0.75); background:rgba(79,141,253,0.15); }
  .form-actions { display:flex; gap:12px; margin-top:8px; }
  .btn { padding:12px 18px; border-radius:12px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.3); color:inherit; cursor:pointer; text-decoration:none; }
  .btn--primary { background:linear-gradient(135deg,#4f8dfd,#8758ff); border:none; color:#fff; }
</style>

<section class="form-card">
  <header class="form-card__header">
    <div>
      <h1>{{ recruiter.name }}</h1>
      <p class="muted">Измените данные и закреплённые города.</p>
    </div>
  </header>

  <form method="post" action="/recruiters/{{ recruiter.id }}/update" class="form-grid" autocomplete="off">
    <label class="field">
      <span>Имя</span>
      <input type="text" name="name" value="{{ recruiter.name }}" required>
    </label>
    <label class="field">
      <span>Часовой пояс</span>
      <input type="text" name="tz" value="{{ recruiter.tz or 'Europe/Moscow' }}" list="tz-list" required>
      <datalist id="tz-list">
        <option value="Europe/Moscow">
        <option value="Europe/Samara">
        <option value="Europe/Kaliningrad">
        <option value="Asia/Yekaterinburg">
        <option value="Asia/Novosibirsk">
        <option value="Asia/Krasnoyarsk">
        <option value="Asia/Irkutsk">
        <option value="Asia/Vladivostok">
        <option value="Asia/Almaty">
      </datalist>
    </label>
    <label class="field">
      <span>Ссылка на Телемост</span>
      <input type="url" name="telemost" value="{{ recruiter.telemost_url or '' }}">
    </label>
    <label class="field">
      <span>Telegram chat_id</span>
      <input type="number" name="tg_chat_id" value="{{ recruiter.tg_chat_id or '' }}" min="1" step="1">
    </label>
    <label class="field">
      <span>Ответственные города</span>
      <div class="city-grid" role="group" aria-label="Ответственные города">
        {% for city in cities %}
          <label class="city-tile">
            <input type="checkbox" name="cities" value="{{ city.id }}" {% if city.id in selected_ids %}checked{% endif %}>
            <span class="city-tile__title">{{ city.name }}</span>
            <span class="city-tile__meta">{{ city.tz }}</span>
          </label>
        {% endfor %}
      </div>
    </label>
    <label class="field field--inline">
      <input type="checkbox" name="active" value="1" {% if recruiter.active %}checked{% endif %}>
      <span>Активен</span>
    </label>
    <div class="form-actions">
      <button class="btn btn--primary" type="submit">Сохранить</button>
      <a class="btn" href="/recruiters">Отмена</a>
    </div>
  </form>
</section>
{% endblock %}
