{% extends "base.html" %}
{% block title %}–î–∞—à–±–æ—Ä–¥{% endblock %}
{% block content %}
<section class="dashboard-hero">
  <div class="hero__copy">
    <p class="hero__eyebrow">TG Bot ¬∑ HR Operations</p>
    <h1 class="hero__title">–¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥–æ–º</h1>
    <p class="hero__description">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤–æ—Ä–æ–Ω–∫–æ–π –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, —Å–ª–æ—Ç–∞–º–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∫–æ–º–∞–Ω–¥—ã –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ —Ä–µ–∞–≥–∏—Ä—É–π—Ç–µ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –ª—é–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.</p>
    <div class="hero__cta-group">
      <a class="btn btn-primary" href="/candidates">–ö –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º</a>
      <a class="btn btn-secondary" href="/recruiters">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫—Ä—É—Ç—ë—Ä–∞–º–∏</a>
    </div>
  </div>
  <div class="hero__actions">
    <p class="hero__actions-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</p>
    <div class="hero__cta-secondary">
      <a class="btn btn-ghost" href="/slots/new">–°–æ–∑–¥–∞—Ç—å —Å–ª–æ—Ç</a>
      <a class="btn btn-ghost" href="/templates/new">–î–æ–±–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω</a>
      <a class="btn btn-ghost" href="/questions/new">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</a>
    </div>
  </div>
</section>

<section class="dashboard-insights">
  <header class="section-header section-header--inline">
    <h2 class="section-title">–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
    <p class="section-hint">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.</p>
  </header>
  <div class="metric-grid">
    <article class="metric-card glass-card">
      <div class="metric-card__head">
        <span class="metric-card__icon" aria-hidden="true">üë•</span>
        <div class="metric-card__title-block">
          <span class="metric-card__label">–†–µ–∫—Ä—É—Ç—ë—Ä—ã</span>
          <span class="metric-card__hint">–ö–æ–º–∞–Ω–¥–∞ –∏ –ø–æ–∫—Ä—ã—Ç–∏–µ</span>
        </div>
      </div>
      <div class="metric-card__body">
        <span class="metric-card__value">{{ counts.recruiters }}</span>
        <ul class="metric-card__meta-list" aria-label="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ —Ä–µ–∫—Ä—É—Ç—ë—Ä–∞–º">
          <li class="metric-card__meta-pill">–ê–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤: {{ counts.cities }}</li>
        </ul>
      </div>
    </article>
    <article class="metric-card glass-card">
      <div class="metric-card__head">
        <span class="metric-card__icon" aria-hidden="true">üóìÔ∏è</span>
        <div class="metric-card__title-block">
          <span class="metric-card__label">–°–ª–æ—Ç—ã</span>
          <span class="metric-card__hint">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</span>
        </div>
      </div>
      <div class="metric-card__body">
        <span class="metric-card__value">{{ counts.slots_total }}</span>
        <ul class="metric-card__meta-list" aria-label="–°—Ç–∞—Ç—É—Å—ã —Å–ª–æ—Ç–æ–≤">
          <li class="metric-card__meta-pill">–°–≤–æ–±–æ–¥–Ω–æ: {{ counts.slots_free }}</li>
          <li class="metric-card__meta-pill">–í –æ–∂–∏–¥–∞–Ω–∏–∏: {{ counts.slots_pending }}</li>
          <li class="metric-card__meta-pill">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ: {{ counts.slots_booked }}</li>
        </ul>
      </div>
    </article>
    <article class="metric-card glass-card">
      <div class="metric-card__head">
        <span class="metric-card__icon" aria-hidden="true">üß™</span>
        <div class="metric-card__title-block">
          <span class="metric-card__label">–¢–µ—Å—Ç 1</span>
          <span class="metric-card__hint">–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∏ –æ—Ç–∫–∞–∑—ã</span>
        </div>
      </div>
      <div class="metric-card__body">
        <span class="metric-card__value">{{ counts.test1_total_seen }}</span>
        <ul class="metric-card__meta-list" aria-label="–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∫–∞–∑–æ–≤">
          <li class="metric-card__meta-pill">–û—Ç–∫–∞–∑—ã: {{ counts.test1_rejections_total }}</li>
          <li class="metric-card__meta-pill">–ö–æ–Ω–≤–µ—Ä—Å–∏—è: {{ counts.test1_rejections_percent }}%</li>
        </ul>
      </div>
    </article>
    <article class="metric-card glass-card">
      <div class="metric-card__head">
        <span class="metric-card__icon" aria-hidden="true">ü§ñ</span>
        <div class="metric-card__title-block">
          <span class="metric-card__label">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–æ—Ç–∞</span>
          <span class="metric-card__hint">–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</span>
        </div>
      </div>
      <div class="metric-card__body">
        <span class="metric-card__value">{{ bot_status.mode|upper }}</span>
        <ul class="metric-card__meta-list" aria-label="–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –±–æ—Ç–∞">
          <li class="metric-card__meta-pill">–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ: {{ '–¥–∞' if bot_status.ready else '–Ω–µ—Ç' }}</li>
        </ul>
      </div>
    </article>
  </div>
</section>

<section class="surface">
  <header class="section-header">
    <h2 class="section-title">–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –±–æ—Ç–∞</h2>
    <p class="section-hint">–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–∞–Ω—Ç–∞–π–º—É –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.</p>
  </header>
  <div class="info-grid" role="list">
    <article class="info-card" role="listitem">
      <span class="info-card__label">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞</span>
      <span class="info-card__value {{ 'info-card__value--positive' if bot_status.config_enabled else 'info-card__value--negative' }}">{{ '–î–∞' if bot_status.config_enabled else '–ù–µ—Ç' }}</span>
    </article>
    <article class="info-card" role="listitem">
      <span class="info-card__label">–†–∞–Ω—Ç–∞–π–º –∞–∫—Ç–∏–≤–µ–Ω</span>
      <span class="info-card__value {{ 'info-card__value--positive' if bot_status.runtime_enabled else 'info-card__value--negative' }}">{{ '–î–∞' if bot_status.runtime_enabled else '–ù–µ—Ç' }}</span>
    </article>
    <article class="info-card" role="listitem">
      <span class="info-card__label">–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞</span>
      <span class="info-card__value {{ 'info-card__value--positive' if bot_status.ready else 'info-card__value--negative' }}">{{ '–î–∞' if bot_status.ready else '–ù–µ—Ç' }}</span>
    </article>
    <article class="info-card" role="listitem">
      <span class="info-card__label">–°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è</span>
      <span class="info-card__value info-card__value--muted">{{ bot_status.health or '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</span>
    </article>
    <article class="info-card" role="listitem">
      <span class="info-card__label">–†–µ–∂–∏–º</span>
      <span class="info-card__value info-card__value--muted">{{ bot_status.mode }}</span>
    </article>
    <article class="info-card" role="listitem">
      <span class="info-card__label">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
      <span class="info-card__value info-card__value--muted">{{ bot_status.updated_at or '‚Äî' }}</span>
    </article>
  </div>
</section>

<section class="surface">
  <header class="section-header">
    <h2 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∞ 1</h2>
    <p class="section-hint">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ–≤ –∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–π.</p>
  </header>
  {% if counts.test1_rejections_breakdown %}
    <div class="list-table-wrapper">
      <table class="list-table">
        <thead>
          <tr>
            <th scope="col">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞</th>
            <th scope="col">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
          </tr>
        </thead>
        <tbody>
          {% for reason, total in counts.test1_rejections_breakdown.items() %}
            <tr>
              <td>{{ reason }}</td>
              <td>{{ total }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤ –ø–æ —Ç–µ—Å—Ç—É.</p>
  {% endif %}
</section>
{% endblock %}
