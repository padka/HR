# Страница «Слоты» — руководство по UI

Обновлённый интерфейс слотов построен на Tailwind/shadcn-компонентах и сохраняет любое пользовательское состояние в параметрах URL, чтобы было удобно делиться ссылками или возвращаться к последнему виду.

## Быстрые фильтры и параметры URL

| Фильтр | Описание | Параметр URL |
| --- | --- | --- |
| Город | Фильтрация по городу проведения | `city_id` (числовой идентификатор) |
| Дата | Показывает слоты на выбранный день (UTC) | `date` в формате `YYYY-MM-DD` |
| Статус | Статусы `FREE`, `PENDING`, `BOOKED`, `CONFIRMED_BY_CANDIDATE`, `CANCELED` | `status` |
| Рекрутер | Ответственный рекрутер | `recruiter_id` |
| Тип слота | Значения поля `purpose` в БД (`interview`, `intro_day`, …) | `purpose` |
| Только будущие | Скрывает прошедшие слоты | `future=1` |
| Вид (таблица/карточки) | Сохраняет предпочтительный layout | `view=table` или `view=cards` |
| Роль времени | Переключает отображение времени для рекрутера/кандидата | `role=recruiter` или `role=candidate` |
| Лимит на страницу | Количество записей на страницу | `per_page` (20/50/100/200/500) |

При смене фильтров страница автоматически сбрасывается на первую страницу (`page=1`).

## Поиск и токены

Поле поиска поддерживает многоразовый ввод. Каждый токен отображается чипсом и хранится в URL в виде повторяющегося параметра `search`. В качестве искомого текста участвуют:

- ID слота и рекрутера;
- ФИО кандидата и его город;
- Метки статуса и тип слота;
- Свободный текст комментариев (через сериализованный JSON).

Удаление токена обновляет URL и фильтрует список на лету.

## Пустые состояния и виртуализация

- При отсутствии результатов отображается подсказка с кнопками «Сбросить фильтры» и «Создать слот».
- При загрузке «тяжёлых» выборок (200+ карточек) активируется виртуализация карточного вида — карточки отрисовываются порциями по 60 элементов по мере прокрутки.
- Ошибочные состояния (например, сбой загрузки экспортного файла) показываются с кнопкой «Повторить».

## Экспорт

Кнопка «Экспорт CSV» выполняет запрос на `GET /api/slots` с текущими фильтрами (`recruiter_id`, `status`, `city_id`, `purpose`, `date`, `future`, `search`, `limit`). Ответ конвертируется в CSV (`ID;Recruiter;Start (UTC);Status;Candidate;Candidate TG`) и скачивается локально. Лимит по умолчанию — 500 записей.

## Пример URL

```
/slots?city_id=5&status=BOOKED&date=2024-11-12&future=1&search=Иванов&search=Москва&view=cards&role=candidate
```

Ссылка открывает карточный вид, отфильтрованный по городу, статусу, дате и поисковым токенам. Возврат к таблице осуществляется через переключатель «Вид» без потери фильтров.
