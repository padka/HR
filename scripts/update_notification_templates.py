#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: {candidate_name}, {recruiter_name}, {dt_local}, {city_name}, {join_link}

–í–ê–ñ–ù–û: –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∏–∂–µ!
"""

import asyncio
import sys
from pathlib import Path

# Add project root to path
project_root = Path(__file__).parent.parent
sys.path.insert(0, str(project_root))

from backend.apps.admin_ui.services.message_templates import create_message_template
from backend.domain.models import City, MessageTemplate
from backend.core.db import async_session
from sqlalchemy import select, update
from datetime import datetime, timezone


# ============================================================================
# ‚ö†Ô∏è –ó–ê–ü–û–õ–ù–ò–¢–ï –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï –ù–ò–ñ–ï ‚ö†Ô∏è
# ============================================================================

# –ê–¥—Ä–µ—Å–∞ –æ—Ñ–∏—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞
CITY_ADDRESSES = {
    "–ú–æ—Å–∫–≤–∞": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1, –æ—Ñ–∏—Å 101",
    "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": "–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 2, –æ—Ñ–∏—Å 202",
    "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": "–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 3, –æ—Ñ–∏—Å 303",
    "–†–æ—Å—Ç–æ–≤": "–≥. –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 4, –æ—Ñ–∏—Å 404",
    "–°–æ—á–∏": "–≥. –°–æ—á–∏, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 5, –æ—Ñ–∏—Å 505",
    "–°–∞–º–∞—Ä–∞": "–≥. –°–∞–º–∞—Ä–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 6, –æ—Ñ–∏—Å 606",
    "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": "–≥. –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 7, –æ—Ñ–∏—Å 707",
    "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": "–≥. –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 8, –æ—Ñ–∏—Å 808",
    "–í–æ–ª–≥–æ–≥—Ä–∞–¥": "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 9, –æ—Ñ–∏—Å 909",
}

# –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π —Ä–µ–≥–∏–æ–Ω–æ–≤
RECRUITER_CONTACTS = {
    "–ú–æ—Å–∫–≤–∞": "+7 (999) 123-45-67",
    "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": "+7 (999) 123-45-68",
    "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": "+7 (999) 123-45-69",
    "–†–æ—Å—Ç–æ–≤": "+7 (999) 123-45-70",
    "–°–æ—á–∏": "+7 (999) 123-45-71",
    "–°–∞–º–∞—Ä–∞": "+7 (999) 123-45-72",
    "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": "+7 (999) 123-45-73",
    "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": "+7 (999) 123-45-74",
    "–í–æ–ª–≥–æ–≥—Ä–∞–¥": "+7 (999) 123-45-75",
}

# –ù–æ–º–µ—Ä HR –æ—Ç–¥–µ–ª–∞ (–µ—Å–ª–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç)
HR_PHONE = "+7 (999) 000-00-00"

# ============================================================================


# 1. –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ (interview_confirmed_candidate)
INTERVIEW_INVITATION = """{candidate_name} üëã

–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º ‚Äî –≤—ã —à–∞–≥ –±–ª–∏–∂–µ –∫ –∫–æ–º–∞–Ω–¥–µ <b>SMART SERVICE</b>!

üóì <b>{dt_local}</b>

üí¨ <b>–§–æ—Ä–º–∞—Ç:</b> –≤–∏–¥–µ–æ—á–∞—Ç WhatsApp | 15‚Äì20 –º–∏–Ω

‚ö° –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ:
‚Ä¢ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
‚Ä¢ —Ä–∞–±–æ—á–∏–π WhatsApp
‚Ä¢ 2‚Äì3 –≤–æ–ø—Ä–æ—Å–∞ –æ –≤–∞–∫–∞–Ω—Å–∏–∏

üîî –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω.

‚úâÔ∏è <b>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—á–∞—Å—Ç–∏–µ</b> –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º ¬´–î–∞¬ª –∏–ª–∏ —ç–º–æ–¥–∑–∏ üëç ‚Äî –±—Ä–æ–Ω–∏—Ä—É—é —Å–ª–æ—Ç."""

# 2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –æ –≤—ã—Ö–æ–¥–µ –Ω–∞ —Å–≤—è–∑—å (confirm_2h)
INTERVIEW_CONFIRMATION_2H = """–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, {candidate_name}! üòä

‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞—é: —Å–µ–≥–æ–¥–Ω—è –≤ <b>{dt_local}</b> (–≤–∞—à–µ –≤—Ä–µ–º—è) ‚Äì –≤–∏–¥–µ–æ—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ Smart‚ö°

üìå –ü–ª–∞–Ω: –∫—Ä–∞—Ç–∫–æ –æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Üí –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã ‚Üí –æ–∂–∏–¥–∞–Ω–∏—è –∏ —Ä–æ—Å—Ç.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç + –∫–∞–º–µ—Ä—É.

üëâ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—á–∞—Å—Ç–∏–µ –æ–¥–Ω–∏–º ¬´–î–∞¬ª –∏–ª–∏ üëç ‚Äì –∂–¥—ë–º –Ω–∞ —Å–≤—è–∑–∏!"""

# 3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–±–µ—Å–∞ - —à–∞–±–ª–æ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞
INTRO_DAY_INVITATION_TEMPLATE = """–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ –≤–∏–¥–µ–æ–∏–Ω—Ç–µ—Ä–≤—å—é –≤ –∫–æ–º–ø–∞–Ω–∏—é <b>SMART</b>! üéâ

–í—Å—Ç—Ä–µ—á–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –Ω–∞ <b>{dt_local}</b>.
üìç –ê–¥—Ä–µ—Å: <b>{city_address}</b>

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –≤ –ø—Ä–µ–∑–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ–º –≤–∏–¥–µ –∏ —Å –æ—Ç–ª–∏—á–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º ‚Äî —ç—Ç–æ –Ω–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ, –∞ <b>–æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ–Ω—å</b> (~2 —á–∞—Å–∞).

‚ú® <b>–ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ:</b>
- –ø—Ä–æ—è–≤–∏—Ç–µ —Å–µ–±—è ‚Äî –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞–∂–Ω—ã;
- –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–Ω—Å —É–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –∏ –∑–∞–¥–∞—á–∏ –∏–∑–Ω—É—Ç—Ä–∏.

üíº <b>–ö–æ–Ω—Ç–∞–∫—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Ä–µ–≥–∏–æ–Ω–∞:</b>
{recruiter_contact}

–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—á–∞—Å—Ç–∏–µ. –ï—Å–ª–∏ –ø–ª–∞–Ω—ã –º–µ–Ω—è—é—Ç—Å—è ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ.

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
–®–µ–Ω—à–∏–Ω –ú–∏—Ö–∞–∏–ª –ê–ª–µ–∫—Å–µ–µ–≤–∏—á
<b>–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å HR-–¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏ SMART</b>"""

# 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—ã–π—Ç–∏ –Ω–∞ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ–Ω—å (intro_day_reminder)
INTRO_DAY_REMINDER = """–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! ‚òÄÔ∏è

–ù–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è –≤ <b>{dt_local}</b> —É –≤–∞—Å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω <b>–æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ–Ω—å –≤ –∫–æ–º–ø–∞–Ω–∏–∏ SMART</b>.

üåü <b>–ß—Ç–æ –≤–∞—Å –∂–¥—ë—Ç?</b>
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–≤–∏–¥–µ—Ç—å —Ä–∞–±–æ—Ç—É –∏–∑–Ω—É—Ç—Ä–∏.
- –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫–æ–º–∞–Ω–¥–æ–π –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.
- –ü–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ —É—Å–ª–æ–≤–∏—è.

üíº <b>–û–¥–µ–∂–¥–∞:</b> –¥–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å, —É–¥–æ–±–Ω—ã–π –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

üëâ –£—Å–ø–µ–≤–∞–µ—Ç–µ? –û—Ç–≤–µ—Ç—å—Ç–µ ¬´–î–∞¬ª. –ï—Å–ª–∏ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç–µ >10 –º–∏–Ω ‚Äì —Å–æ–æ–±—â–∏—Ç–µ –ø–æ ‚òé {hr_phone}"""


async def update_existing_template(key: str, body: str):
    """–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —à–∞–±–ª–æ–Ω."""
    async with async_session() as session:
        # –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ã–π —à–∞–±–ª–æ–Ω
        template = await session.scalar(
            select(MessageTemplate).where(
                MessageTemplate.key == key,
                MessageTemplate.locale == "ru",
                MessageTemplate.channel == "tg",
                MessageTemplate.is_active == True
            )
        )

        if template:
            # –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
            template.body_md = body
            template.version += 1
            template.updated_at = datetime.now(timezone.utc)
            await session.commit()
            print(f"‚úì –û–±–Ω–æ–≤–ª–µ–Ω —à–∞–±–ª–æ–Ω: {key} (–≤–µ—Ä—Å–∏—è {template.version})")
        else:
            # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
            success, errors, new_template = await create_message_template(
                key=key,
                locale="ru",
                channel="tg",
                body=body,
                is_active=True,
                version=1
            )
            if success:
                print(f"‚úì –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω: {key}")
            else:
                print(f"‚úó –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞ {key}: {errors}")


async def create_city_specific_template(city_name: str):
    """–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–Ω—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞."""
    city_address = CITY_ADDRESSES.get(city_name, f"–≥. {city_name}, –∞–¥—Ä–µ—Å —É—Ç–æ—á–Ω—è–µ—Ç—Å—è")
    recruiter_contact = RECRUITER_CONTACTS.get(city_name, "+7 (XXX) XXX-XX-XX")

    body = INTRO_DAY_INVITATION_TEMPLATE.replace("{city_address}", city_address)
    body = body.replace("{recruiter_contact}", recruiter_contact)

    # –ö–ª—é—á —à–∞–±–ª–æ–Ω–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –≥–æ—Ä–æ–¥–∞
    key = f"intro_day_invitation_{city_name.lower()}"

    async with async_session() as session:
        # –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏
        await session.execute(
            update(MessageTemplate)
            .where(
                MessageTemplate.key == key,
                MessageTemplate.locale == "ru",
                MessageTemplate.channel == "tg"
            )
            .values(is_active=False)
        )
        await session.commit()

    # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
    success, errors, template = await create_message_template(
        key=key,
        locale="ru",
        channel="tg",
        body=body,
        is_active=True,
        version=1
    )

    if success:
        print(f"‚úì –°–æ–∑–¥–∞–Ω —à–∞–±–ª–æ–Ω –¥–ª—è –≥–æ—Ä–æ–¥–∞: {city_name}")
    else:
        print(f"‚úó –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞ –¥–ª—è {city_name}: {errors}")


async def main():
    print("=" * 60)
    print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π")
    print("=" * 60)
    print()

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
    placeholder_found = False
    for city, address in CITY_ADDRESSES.items():
        if "–ü—Ä–∏–º–µ—Ä–Ω–∞—è" in address or "XXX" in RECRUITER_CONTACTS.get(city, ""):
            placeholder_found = True
            print(f"‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –î–ª—è –≥–æ—Ä–æ–¥–∞ {city} –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ!")

    if "XXX" in HR_PHONE:
        placeholder_found = True
        print(f"‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: HR —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω!")

    if placeholder_found:
        print()
        print("‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n)")
        response = input().strip().lower()
        if response != 'y':
            print("–û—Ç–º–µ–Ω–µ–Ω–æ. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞.")
            return
        print()

    # 1. –û–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ
    print("1Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ...")
    await update_existing_template("interview_confirmed_candidate", INTERVIEW_INVITATION)
    print()

    # 2. –û–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞ 2 —á–∞—Å–∞
    print("2Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞ 2 —á–∞—Å–∞...")
    await update_existing_template("confirm_2h", INTERVIEW_CONFIRMATION_2H)
    print()

    # 3. –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–Ω—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞
    print("3Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–Ω—è –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤...")
    async with async_session() as session:
        cities = await session.scalars(select(City).where(City.active == True))
        for city in cities:
            if city.name != "–¢–µ—Å—Ç–æ–≤—ã–π –≥–æ—Ä–æ–¥":  # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –≥–æ—Ä–æ–¥
                await create_city_specific_template(city.name)
    print()

    # 4. –û–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–º –¥–Ω–µ–º
    print("4Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–º –¥–Ω–µ–º...")
    reminder_text = INTRO_DAY_REMINDER.replace("{hr_phone}", HR_PHONE)
    await update_existing_template("intro_day_reminder", reminder_text)
    print()

    print("=" * 60)
    print("‚úÖ –í—Å–µ —à–∞–±–ª–æ–Ω—ã —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!")
    print("=" * 60)
    print()
    if placeholder_found:
        print("‚ö†Ô∏è  –í–ê–ñ–ù–û: –ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å:")
        print("   - –ê–¥—Ä–µ—Å–∞ –æ—Ñ–∏—Å–æ–≤ –≤ CITY_ADDRESSES")
        print("   - –ö–æ–Ω—Ç–∞–∫—Ç—ã —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –≤ RECRUITER_CONTACTS")
        print("   - –ù–æ–º–µ—Ä HR –≤ HR_PHONE")
        print()
        print("   –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.")
        print()


if __name__ == "__main__":
    asyncio.run(main())
