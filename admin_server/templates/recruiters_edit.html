{% extends "base.html" %}
{% block title %}Редактирование рекрутёра{% endblock %}
{% block content %}

<style>
  .form-card { padding:24px; border-radius:20px; backdrop-filter:blur(30px); border:1px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.04); max-width:720px; }
  .form-grid { display:grid; gap:16px; }
  .field { display:flex; flex-direction:column; gap:6px; }
  .field input, .field select { padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.25); color:inherit; }
  .inline { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
  .city-grid { display:grid; gap:10px; grid-template-columns:repeat(auto-fit, minmax(160px, 1fr)); }
  .city-tile { position:relative; display:flex; flex-direction:column; gap:4px; padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.22); cursor:pointer; transition:background .2s, border-color .2s; }
  .city-tile input { position:absolute; inset:0; opacity:0; cursor:pointer; }
  .city-tile__title { font-weight:600; }
  .city-tile__meta { font-size:12px; color:var(--muted,rgba(255,255,255,0.55)); }
  .city-tile:has(input:checked) { border-color:rgba(79,141,253,0.75); background:rgba(79,141,253,0.15); }
  .muted { color:var(--muted,rgba(255,255,255,0.55)); font-size:13px; }
  .button { padding:12px 18px; border-radius:12px; border:1px solid rgba(255,255,255,0.08); background:rgba(0,0,0,0.3); color:inherit; cursor:pointer; text-decoration:none; }
  .button--primary { background:linear-gradient(135deg,#4f8dfd,#8758ff); border:none; color:#fff; }
</style>

<section class="form-card">
  <h1 style="margin-top:0; margin-bottom:12px; font-size:24px; font-weight:600;">{{ recruiter.name }}</h1>
  <p class="muted" style="margin-top:0; margin-bottom:24px;">Измените контактные данные и список городов. Все изменения применяются мгновенно.</p>

  <form id="recForm" method="post" action="/recruiters/{{ recruiter.id }}/update" autocomplete="off" class="form-grid">
    <div class="field">
      <label for="name">Имя</label>
      <input id="name" type="text" name="name" value="{{ recruiter.name }}" required>
    </div>

    <div class="field">
      <label for="tz">Часовой пояс</label>
      <input id="tz" type="text" name="tz" value="{{ recruiter.tz or 'Europe/Moscow' }}" list="tz-list" required>
      <datalist id="tz-list">
        <option value="Europe/Moscow">
        <option value="Europe/Samara">
        <option value="Europe/Kaliningrad">
        <option value="Asia/Yekaterinburg">
        <option value="Asia/Novosibirsk">
        <option value="Asia/Krasnoyarsk">
        <option value="Asia/Irkutsk">
        <option value="Asia/Vladivostok">
        <option value="Asia/Almaty">
      </datalist>
    </div>

    <div class="field">
      <label for="telemost">Ссылка на Яндекс.Телемост</label>
      <input id="telemost" type="url" name="telemost" value="{{ recruiter.telemost_url or '' }}" placeholder="https://telemost.yandex.ru/j/XXXXX">
    </div>

    <div class="field">
      <label for="tg_chat_id">Telegram chat_id</label>
      <div class="inline">
        <input id="tg_chat_id" type="number" name="tg_chat_id" inputmode="numeric" min="1" step="1" value="{{ recruiter.tg_chat_id or '' }}" style="max-width:200px;">
        <span class="muted">Оставьте пустым, если chat_id ещё не известен.</span>
      </div>
    </div>

    <div class="field">
      <span>Ответственные города</span>
      <div class="city-grid" role="group" aria-label="Ответственные города">
        {% for city in cities %}
          <label class="city-tile">
            <input type="checkbox" name="cities" value="{{ city.id }}" {% if city.id in selected_ids %}checked{% endif %}>
            <span class="city-tile__title">{{ city.name }}</span>
            <span class="city-tile__meta">{{ city.tz }}</span>
          </label>
        {% endfor %}
      </div>
      <span class="muted">Отметьте города, за которые отвечает рекрутёр.</span>
    </div>

    <div class="field">
      <label class="inline" style="gap:8px;">
        <input id="active" type="checkbox" name="active" value="1" {% if recruiter.active %}checked{% endif %}>
        Активен
      </label>
    </div>

    <div class="inline" style="margin-top:8px;">
      <button class="button button--primary" type="submit">Сохранить изменения</button>
      <a class="button" href="/recruiters">Отмена</a>
    </div>
  </form>
</section>

{% endblock %}
