<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Админка{% endblock %} · TG Bot Admin</title>
  <link rel="icon" href="/static/favicon.ico">
  <style>
  /* ===== Liquid Glass v2 (Three-Layer, minimal motion) ===== */
  :root {
    /* base palette */
    --bg: #0b0e13;
    --fg: #e9eef6;
    --muted: #aab3c2;

    /* accents */
    --accent: #69b7ff;
    --accent-2: #b889ff;

    /* glass tokens */
    --glass-tint: rgba(255, 255, 255, 0.06);     /* base transmission */
    --glass-stroke: rgba(255, 255, 255, 0.14);   /* outer edge */
    --glass-inner: rgba(0, 0, 0, 0.25);          /* inner depth tint */
    --glass-top: rgba(255, 255, 255, 0.22);      /* top optical layer */
    --glass-bottom: rgba(0, 0, 0, 0.18);         /* bottom absorption */
    --specular: rgba(255, 255, 255, 0.55);       /* sharp highlight lines */
    --edge-light: rgba(255, 255, 255, 0.35);     /* hairline edge light */
    --edge-shadow: rgba(0, 0, 0, 0.45);          /* hairline edge shadow */
    --ring: #62a8ff;

    /* states */
    --ok: #23d18b;  --warn: #ffd166;  --bad: #ff6b6b;

    /* elevation */
    --shadow-1: 0 1px 1px rgba(0,0,0,.25), 0 2px 6px rgba(0,0,0,.22);
    --shadow-2: 0 8px 20px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05);
    --shadow-3: 0 16px 40px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06);

    /* layout */
    --radius-lg: 16px; --radius-md: 12px; --radius-sm: 10px;

    /* table */
    --row-sep: rgba(255,255,255,.06);  --border: rgba(255,255,255,.12);

    /* optics */
    --blur: 16px;             /* base blur for panes */
    --sat: 1.35;              /* base saturation */
    --bright: 1.02;           /* base brightness to lift content */
  }

  @media (prefers-color-scheme: light) {
    :root {
      --bg: #f6f7fb; --fg: #0f1a2a; --muted: #5b6372;
      --glass-tint: rgba(255,255,255,.55);
      --glass-stroke: rgba(0,0,0,.12);
      --glass-inner: rgba(255,255,255,.35);
      --glass-top: rgba(255, 255, 255, 0.9);
      --glass-bottom: rgba(0, 0, 0, 0.06);
      --specular: rgba(255,255,255,.8);
      --edge-light: rgba(255,255,255,.9);
      --edge-shadow: rgba(0,0,0,.14);
      --ring: #2d7cff;
      --row-sep: rgba(0,0,0,.06); --border: rgba(0,0,0,.12);
      --bright: 1.00;
    }
  }

  * { box-sizing: border-box; }
  html, body { height: 100%; }

  body {
    margin: 0;
    background:
      radial-gradient(1200px 800px at 10% 0%, rgba(105,183,255,.10), transparent 60%),
      radial-gradient(1200px 900px at 100% 100%, rgba(184,137,255,.10), transparent 60%),
      linear-gradient(180deg, #0b0e13 0%, #0d1118 100%);
    color: var(--fg);
    font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    overflow-x: hidden;
  }

  /* Ambient halo (static, minimal motion) */
  .halo {
    position: fixed; inset: -30%; z-index: -2; pointer-events: none;
    background:
      radial-gradient(40% 40% at 10% 0%, rgba(105,183,255,.16), transparent 60%),
      radial-gradient(45% 45% at 90% 85%, rgba(184,137,255,.16), transparent 62%),
      radial-gradient(35% 35% at 65% 35%, rgba(35,209,139,.16), transparent 65%);
    filter: blur(55px) saturate(1.1);
  }

  /* Fine grain overlay for glass material */
  .grain::after {
    content: ""; position: absolute; inset: 0; pointer-events: none;
    background-image:
      radial-gradient(rgba(255,255,255,.08) 1px, transparent 1px),
      radial-gradient(rgba(0,0,0,.08) 1px, transparent 1px);
    background-size: 2px 2px, 3px 3px;
    mix-blend-mode: overlay; opacity: .05; border-radius: inherit;
  }

  /* Links */
  a { color: var(--accent); text-decoration: none; }
  a:hover { text-decoration: underline; }

  /* ---- Three-layer Glass primitive ----
     Layer model:
     - Base: translucent tint + bottom absorption
     - ::before: top optical highlight & hairline edge light
     - ::after: internal vignette & edge shadow for depth
  */
  .glass {
    position: relative; border-radius: var(--radius-lg);
    background: linear-gradient(180deg, var(--glass-tint), rgba(255,255,255,0.02)),
                linear-gradient(180deg, rgba(255,255,255,0), var(--glass-bottom));
    border: 1px solid var(--glass-stroke);
    box-shadow: var(--shadow-2);
    isolation: isolate;
  }
  @supports ((backdrop-filter: blur(var(--blur))) or (-webkit-backdrop-filter: blur(var(--blur)))) {
    .glass {
      backdrop-filter: blur(var(--blur)) saturate(var(--sat)) brightness(var(--bright));
      -webkit-backdrop-filter: blur(var(--blur)) saturate(var(--sat)) brightness(var(--bright));
      background: linear-gradient(180deg, var(--glass-tint), var(--glass-inner));
    }
  }
  .glass::before,
  .glass::after {
    content: ""; position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
  }
  /* top optical highlight + thin specular streaks */
  .glass::before {
    background:
      linear-gradient( to top left, rgba(255,255,255,.16), transparent 60%),
      linear-gradient( 90deg,
        transparent 0%, rgba(255,255,255,.08) 8%, transparent 14%,
        transparent 86%, rgba(255,255,255,.06) 92%, transparent 100% );
    mix-blend-mode: screen; opacity: .8;
  }
  /* inner vignette + edge shadow gives curvature illusion */
  .glass::after {
    box-shadow: inset 0 1px 0 rgba(255,255,255,.06), inset 0 0 0 1px rgba(255,255,255,.03);
    background:
      radial-gradient(120% 90% at 50% 110%, rgba(0,0,0,.18), transparent 65%),
      radial-gradient(100% 80% at -10% 0%, rgba(255,255,255,.06), transparent 55%);
    opacity: .9;
  }

  header { position: sticky; top: 0; z-index: 20; padding: 10px 16px; background: transparent; }

  .nav {
    max-width: 1100px; margin: 0 auto; padding: 10px 12px;
    display: flex; align-items: center; gap: 14px; border-radius: var(--radius-lg);
    position: relative;
  }
  /* nav as glass */
  .nav { border: 1px solid var(--glass-stroke); box-shadow: var(--shadow-1); }
  .nav { background: linear-gradient(180deg, var(--glass-tint), rgba(255,255,255,.02)); }
  @supports ((backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px))) {
    .nav { backdrop-filter: blur(16px) saturate(1.2); -webkit-backdrop-filter: blur(16px) saturate(1.2); }
  }
  .nav::before, .nav::after { content: ""; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; }
  .nav::before { background: linear-gradient( to top left, rgba(255,255,255,.14), transparent 60% ); mix-blend-mode: screen; }
  .nav::after { box-shadow: inset 0 1px 0 rgba(255,255,255,.06); }

  .nav .brand { font-weight: 800; letter-spacing: .2px; color: #fff; margin-right: 6px; text-shadow: 0 1px 2px rgba(0,0,0,.35); }
  .nav a { color: var(--fg); opacity: .85; padding: 6px 10px; border-radius: 8px; }
  .nav a.active { color: #fff; font-weight: 600; background: rgba(255,255,255,.06); box-shadow: inset 0 1px 0 rgba(255,255,255,.08); text-decoration: none; }

  .container { max-width: 1100px; margin: 0 auto; padding: 16px; }

  .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 14px; margin: 14px 0 24px; }
  .card { border-radius: var(--radius-lg); padding: 14px; position: relative; overflow: hidden; }
  .card { background: linear-gradient(180deg, var(--glass-tint), rgba(255,255,255,.02)); border: 1px solid var(--glass-stroke); box-shadow: var(--shadow-2); }
  @supports ((backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px))) {
    .card { backdrop-filter: blur(18px) saturate(1.35); -webkit-backdrop-filter: blur(18px) saturate(1.35); }
  }
  .card::before, .card::after { content: ""; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; }
  .card::before { background: linear-gradient( 130deg, rgba(255,255,255,.12), transparent 40% ); mix-blend-mode: screen; opacity: .8; }
  .card::after { background: radial-gradient(120% 90% at 50% 110%, rgba(0,0,0,.18), transparent 65%); box-shadow: inset 0 1px 0 rgba(255,255,255,.06); }

  .card h4 { margin: 0 0 10px 0; font-size: 13px; color: var(--muted); font-weight: 700; letter-spacing: .32px; text-transform: uppercase; }
  .card .big { font-size: 30px; font-weight: 900; letter-spacing: .2px; }
  .badge { padding: 2px 8px; border-radius: 999px; border: 1px solid var(--glass-stroke); background: rgba(255,255,255,.06); color: var(--muted); font-size: 12px; }
  .muted { color: var(--muted); }

  /* tables in glass */
  table { width: 100%; border-collapse: collapse; border-radius: var(--radius-lg); overflow: hidden; }
  thead th {
    text-align: left; color: var(--muted); font-weight: 700; letter-spacing: .3px; text-transform: uppercase; font-size: 12px;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border-bottom: 1px solid var(--border);
    padding: 10px 12px;
  }
  tbody td { padding: 10px 12px; border-bottom: 1px solid var(--row-sep); }
  tbody tr:hover { background: rgba(255,255,255,.03); }
  table { background: linear-gradient(180deg, var(--glass-tint), rgba(255,255,255,.015)); border: 1px solid var(--glass-stroke); box-shadow: var(--shadow-1); }
  @supports ((backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px))) {
    table { backdrop-filter: blur(14px) saturate(1.25); -webkit-backdrop-filter: blur(14px) saturate(1.25); }
  }

  /* forms */
  form label { display: inline-block; margin: 6px 12px 6px 0; }
  input, select, textarea {
    background: rgba(12,14,19,.65);
    color: var(--fg);
    border: 1px solid var(--glass-stroke);
    border-radius: var(--radius-md);
    padding: 8px 10px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
  }
  input:focus, select:focus, textarea:focus {
    outline: none; border-color: var(--ring);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--ring) 35%, transparent);
  }

  /* buttons */
  button, .btn {
    display: inline-block; padding: 9px 14px; border-radius: var(--radius-md);
    border: 1px solid var(--glass-stroke);
    background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
    color: var(--fg); cursor: pointer;
    box-shadow: var(--shadow-1), inset 0 1px 0 rgba(255,255,255,.06);
    transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
    position: relative; overflow: hidden;
  }
  button:hover, .btn:hover { background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.04)); transform: translateY(-.5px); box-shadow: var(--shadow-2); text-decoration: none; }
  button:active, .btn:active { transform: translateY(0); box-shadow: var(--shadow-1); }
  button:focus-visible, .btn:focus-visible { outline: none; box-shadow: 0 0 0 4px color-mix(in oklab, var(--ring) 32%, transparent), var(--shadow-2); }

  /* reduced motion: ensure no fancy transforms */
  @media (prefers-reduced-motion: reduce) {
    * { animation: none !important; transition: none !important; }
  }
</style>
</head>
<body>
  <!-- Ambient halo for Liquid Glass -->
  <div aria-hidden="true" class="halo"></div>
  <header>
    <nav class="nav">
      <a class="brand" href="/">TG Bot Admin</a>
      <a href="/" class="{% if request.url.path == '/' %}active{% endif %}">Дашборд</a>
      <a href="/recruiters" class="{% if request.url.path.startswith('/recruiters') %}active{% endif %}">Рекрутёры</a>
      {# Активен для /cities, /cities/new, /cities/<id>*, но НЕ для /cities/owners #}
      <a href="/cities" class="{% if request.url.path == '/cities' or (request.url.path.startswith('/cities/') and not request.url.path.startswith('/cities/owners')) %}active{% endif %}">Города</a>
      <a href="/cities/owners" class="{% if request.url.path.startswith('/cities/owners') %}active{% endif %}">Ответственные</a>
      <a href="/slots" class="{% if request.url.path.startswith('/slots') %}active{% endif %}">Слоты</a>
      <a href="/templates" class="{% if request.url.path.startswith('/templates') %}active{% endif %}">Шаблоны</a>
      <a href="/questions" class="{% if request.url.path.startswith('/questions') %}active{% endif %}">Вопросы</a>
      <span style="margin-left:auto" class="badge">{{ request.url.hostname or 'localhost' }}</span>
    </nav>
  </header>

  <main class="container">
    {% block content %}{% endblock %}
  </main>
<script>
  (function(){
    const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // Tilt: opt-in via [data-tilt], very small amplitude
    if (!reduce) {
      const tiltTargets = Array.from(document.querySelectorAll('[data-tilt]'));
      tiltTargets.forEach(el => {
        let frame, rx = 0, ry = 0, tx = 0, ty = 0;
        const ease = 0.12; const rect = () => el.getBoundingClientRect();
        const max = 2; // deg
        const onMove = (e) => {
          const r = rect(); const x = (e.clientX - r.left) / r.width; const y = (e.clientY - r.top) / r.height;
          rx = (0.5 - y) * max; ry = (x - 0.5) * max; if (!frame) loop();
        };
        const onLeave = () => { rx = 0; ry = 0; if (!frame) loop(); };
        function loop(){
          frame = requestAnimationFrame(()=>{
            tx += (rx - tx) * ease; ty += (ry - ty) * ease;
            el.style.transform = `perspective(900px) rotateX(${tx}deg) rotateY(${ty}deg)`;
            if (Math.abs(tx - rx) > 0.01 || Math.abs(ty - ry) > 0.01) loop(); else { cancelAnimationFrame(frame); frame = null; }
          });
        }
        el.addEventListener('mousemove', onMove);
        el.addEventListener('mouseleave', onLeave);
      });
    }

    // Ripple for buttons/links with .btn (skip if reduced motion)
    if (!reduce) {
      const rippleTargets = document.querySelectorAll('button, .btn');
      rippleTargets.forEach(btn => {
        btn.style.position = btn.style.position || 'relative';
        btn.style.overflow = 'hidden';
        btn.addEventListener('click', (e) => {
          const d = Math.max(btn.clientWidth, btn.clientHeight);
          const r = document.createElement('span');
          r.style.position = 'absolute'; r.style.width = r.style.height = d + 'px';
          r.style.left = (e.offsetX - d/2) + 'px'; r.style.top = (e.offsetY - d/2) + 'px';
          r.style.borderRadius = '50%';
          r.style.background = 'radial-gradient(circle, rgba(255,255,255,.30) 0%, rgba(255,255,255,0) 60%)';
          r.style.transform = 'scale(0)'; r.style.opacity = '0.7'; r.style.pointerEvents = 'none';
          r.style.transition = 'transform .45s ease, opacity .6s ease';
          btn.appendChild(r);
          requestAnimationFrame(() => { r.style.transform = 'scale(1)'; r.style.opacity = '0'; });
          setTimeout(() => r.remove(), 620);
        });
      });
    }
  })();
</script>
</body>
</html>