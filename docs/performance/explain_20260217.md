# EXPLAIN Artifacts (local) — 2026-02-17

Цель: приложить “сырые” планы для top SQL из perf профилирования (если возможно).

Примечание: на локальной БД объёмы могут быть небольшими, поэтому planner может выбирать `Seq Scan`. На прод-объёмах планы и индексы могут отличаться; используйте эти запросы как шаблоны для повторного EXPLAIN на staging/prod.

## 1) Waiting candidates count

SQL:

```sql
EXPLAIN (ANALYZE, BUFFERS)
SELECT count(*)
FROM users
WHERE candidate_status IN (
  'waiting_slot'::candidate_status_enum,
  'stalled_waiting_slot'::candidate_status_enum
);
```

Output (local):

```text
Aggregate  (actual time=0.012..0.012 rows=1 loops=1)
  ->  Seq Scan on users  (actual time=0.010..0.010 rows=1 loops=1)
        Filter: (candidate_status = ANY ('{waiting_slot,stalled_waiting_slot}'::candidate_status_enum[]))
Planning Time: 2.799 ms
Execution Time: 0.030 ms
```

## 2) Active recruiters count

SQL:

```sql
EXPLAIN (ANALYZE, BUFFERS)
SELECT count(*)
FROM recruiters
WHERE active IS true;
```

Output (local):

```text
Aggregate  (actual time=0.618..0.618 rows=1 loops=1)
  ->  Seq Scan on recruiters  (actual time=0.615..0.615 rows=1 loops=1)
        Filter: (active IS TRUE)
Planning Time: 2.093 ms
Execution Time: 0.650 ms
```

## 3) Slots by status (dashboard counts)

SQL:

```sql
EXPLAIN (ANALYZE, BUFFERS)
SELECT status, count(*)
FROM slots
WHERE status != 'canceled'
GROUP BY status;
```

Output (local):

```text
GroupAggregate  (actual time=0.821..0.822 rows=1 loops=1)
  Group Key: status
  ->  Sort  (actual time=0.818..0.818 rows=1 loops=1)
        Sort Key: status
        ->  Seq Scan on slots  (actual time=0.484..0.489 rows=1 loops=1)
              Filter: ((status)::text <> 'canceled'::text)
Planning Time: 9.621 ms
Execution Time: 0.841 ms
```

